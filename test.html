<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>æˆ‘çš„éŸ“åœ‹æ—…éŠåŠ©æ‰‹</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #F8FAFC; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .bg-teal-main { background-color: #43968F; }
    </style>
</head>
<body class="max-w-md mx-auto min-h-screen shadow-2xl overflow-x-hidden">

<div id="app">
    <div class="bg-teal-main text-white pt-8 pb-4 px-5 rounded-b-[40px] shadow-lg">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-bold">é‡œå±±è¡Œ ğŸ‡°ğŸ‡·</h1>
            <button @click="addNewDay" class="bg-white/20 px-3 py-1 rounded-full text-xs">
                <i class="fas fa-calendar-plus mr-1"></i>æ–°å¢ä¸€å¤©
            </button>
        </div>

        <div class="flex gap-3 overflow-x-auto hide-scrollbar pb-2">
            <div v-for="(day, index) in days" :key="index" 
                 @click="currentDayIndex = index"
                 :class="['flex-shrink-0 w-16 h-20 rounded-2xl flex flex-col items-center justify-center transition-all', 
                          currentDayIndex === index ? 'bg-white text-[#43968F] shadow-md' : 'bg-white/20 text-white opacity-70']">
                <span class="text-[10px]">{{ day.dateLabel }}</span>
                <span class="text-xl font-bold">D{{ index + 1 }}</span>
            </div>
        </div>
    </div>

    <main class="p-5">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">Day {{ currentDayIndex + 1 }} è¡Œç¨‹</h2>
            <button @click="showModal = true" class="text-teal-main font-bold">+ æ–°å¢è¡Œç¨‹</button>
        </div>

        <div v-if="currentDayItems.length === 0" class="text-center py-20 text-gray-300">
            ç›®å‰é€™å¤©é‚„æ²’æœ‰è¡Œç¨‹å–”ï¼
        </div>

        <div class="space-y-4">
            <div v-for="(item, idx) in currentDayItems" :key="idx" class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex justify-between">
                <div>
                    <span class="text-xs font-bold text-teal-main">{{ item.time }}</span>
                    <h4 class="font-bold text-gray-800 text-lg">{{ item.location }}</h4>
                </div>
                <button @click="deleteItem(idx)" class="text-red-300 px-2"><i class="fas fa-trash"></i></button>
            </div>
        </div>
        
        <button v-if="days.length > 1" @click="removeDay" class="mt-10 w-full text-red-400 text-sm opacity-50">åˆªé™¤é€™ä¸€å¤©è¡Œç¨‹</button>
    </main>

    <div v-if="showModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-end">
        <div class="bg-white w-full rounded-t-[32px] p-8">
            <h3 class="text-xl font-bold mb-4">æ–°å¢è¡Œç¨‹</h3>
            <input v-model="newItem.time" type="time" class="w-full p-4 bg-gray-50 rounded-2xl mb-4 border-none ring-1 ring-gray-100">
            <input v-model="newItem.location" type="text" placeholder="è¦å»å“ªè£¡ï¼Ÿ" class="w-full p-4 bg-gray-50 rounded-2xl mb-6 border-none ring-1 ring-gray-100">
            <div class="flex gap-4">
                <button @click="saveItem" class="flex-1 bg-teal-main text-white py-4 rounded-2xl font-bold">ç¢ºèª</button>
                <button @click="showModal = false" class="flex-1 bg-gray-100 text-gray-500 py-4 rounded-2xl font-bold">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, computed, watch, onMounted } = Vue;

    createApp({
        setup() {
            const currentDayIndex = ref(0);
            const showModal = ref(false);
            const newItem = ref({ time: '', location: '' });
            
            // åˆå§‹è³‡æ–™æ¶æ§‹
            const days = ref([
                { dateLabel: '02/23', items: [{time: '12:00', location: 'æŠµé”é‡œå±±'}] }
            ]);

            const currentDayItems = computed(() => days.value[currentDayIndex.value]?.items || []);

            // åŠŸèƒ½ï¼šæ–°å¢æ—¥æœŸ
            const addNewDay = () => {
                const lastDay = days.value[days.value.length - 1];
                // é€™è£¡ç°¡å–®è™•ç†æ—¥æœŸéå¢ï¼Œå¯¦éš›å¯ä¸²æ¥ Date ç‰©ä»¶
                days.value.push({ dateLabel: 'Next', items: [] });
                currentDayIndex.value = days.value.length - 1;
            };

            const removeDay = () => {
                if(confirm('ç¢ºå®šè¦åˆªé™¤é€™æ•´å¤©çš„è¡Œç¨‹å—ï¼Ÿ')) {
                    days.value.splice(currentDayIndex.value, 1);
                    currentDayIndex.value = 0;
                }
            }

            const saveItem = () => {
                if (newItem.value.time && newItem.value.location) {
                    days.value[currentDayIndex.value].items.push({ ...newItem.value });
                    days.value[currentDayIndex.value].items.sort((a, b) => a.time.localeCompare(b.time));
                    newItem.value = { time: '', location: '' };
                    showModal.value = false;
                }
            };

            const deleteItem = (idx) => {
                days.value[currentDayIndex.value].items.splice(idx, 1);
            }

            // --- é—œéµåŠŸèƒ½ï¼šæœ¬åœ°å„²å­˜ ---
            watch(days, (newVal) => {
                localStorage.setItem('korea_travel_data', JSON.stringify(newVal));
            }, { deep: true });

            onMounted(() => {
                const saved = localStorage.getItem('korea_travel_data');
                if (saved) {
                    days.value = JSON.parse(saved);
                }
            });

            return { days, currentDayIndex, currentDayItems, showModal, newItem, addNewDay, saveItem, deleteItem, removeDay };
        }
    }).mount('#app')
</script>
</body>
</html>
